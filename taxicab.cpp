// g++ -O3 -o taxicab taxicab.cpp -L/usr/local/lib -lflint && LD_LIBRARY_PATH=/usr/local/lib ./taxicab

#include <iostream>
#include <iomanip>
#include <map>
#include <vector>
#include <string>
#include <flint/fmpz.h>

using namespace std;

int main() {
    // Taxicab(n) = N = r*s = x(1)³ + y(1)³ [= ... = x(n)³ + y(n)³]
    map<unsigned short, string> taxicab;
    map<unsigned short, map<unsigned short, string>> taxicab_delta;
    map<unsigned short, map<unsigned short, string>> taxicab_r;
    map<unsigned short, map<unsigned short, string>> taxicab_s;
    map<unsigned short, map<unsigned short, string>> taxicab_x;
    map<unsigned short, map<unsigned short, string>> taxicab_y;

    taxicab = {
        {  1, "2" },
        {  2, "1729" },
        {  3, "87539319" },
        {  4, "6963472309248" },
        {  5, "48988659276962496" },
        {  6, "24153319581254312065344" },
        {  7, "24885189317885898975235988544" },
        {  8, "50974398750539071400590819921724352" },
        {  9, "136897813798023990395783317207361432493888" },
        { 10, "7335345315241855602572782233444632535674275447104" },
        { 11, "87039729655193781808322993393446581825405320183232000" },
        { 12, "16119148654034302034428760115512552827992287460693283776000" },
        { 13, "98785992977316717572070208794037178343163969803121800608526912000" },
        { 14, "6181115942163278484307116174514304039670628856329988877227399275142976000" },
        //{ 15, "786630615595626829796137755567437844038832146564530660386728812791938555036352000" },
    };

    taxicab_r = {
        { 1, {{1, "1"}}},
        { 2, {{1, "13"}, {2, "19"}}},
        { 3, {{1, "603"}, {2, "651"}, {3, "669"}}},
        { 4, {{1, "21504"}, {2, "24384"}, {3, "28272"}, {4, "29952"}}},
        { 5, {{1, "404544"}, {2, "470592"}, {3, "548244"}, {4, "558012"}, {5, "563472"}}},
        { 6, {{1, "29488368"}, {2, "31958976"}, {3, "37176768"}, {4, "43311276"},
              {5, "44082948"}, {6, "44514288"}}},
        { 7, {{1, "2978325168"}, {2, "3227856576"}, {3, "3375266076"}, {4, "3754853568"},
              {5, "4374438876"}, {6, "4452377748"}, {7, "4495943088"}}},
        { 8, {{1, "378247296336"}, {2, "409937785152"}, {3, "428658791652"},
              {4, "476866403136"}, {5, "555553737252"}, {6, "565451973996"},
              {7, "570984772176"}, {8, "588385726452"}}},
        { 9, {{1, "52576374190704"}, {2, "55606919948244"}, {3, "56981352136128"},
              {4, "59583572039628"}, {5, "66284430035904"}, {6, "77221969478028"},
              {7, "78597824385444"}, {8, "79366883332464"}, {9, "81785615976828"}}},
        {10, {{1, "19821293069895408"}, {2, "20333449111839444"}, {3, "20963808820487988"},
              {4, "21481969755320256"}, {5, "22463006658939756"}, {6, "24989230123535808"},
              {7, "29112682493216556"}, {8, "29631379793312388"}, {9, "29921315016338928"}, 
              {10, "30833177223264156"}}},
        {11, {{1, "448306482152256000"}, {2, "470227943453541000"}, {3, "566827508371258680"},
              {4, "577182990203814120"}, {5, "632749122066516000"}, {6, "636779494370990880"},
              {7, "638691321198545160"}, {8, "691170863615919960"}, {9, "692202451000089120"},
              {10, "695224564632004680"}, {11, "697556880756014760"}}},
        {12, {{1, "25553469482678592000"}, {2, "26031756460824780120"}, {3, "26802992776851837000"},
              {4, "32309167977161744760"}, {5, "32899430441617404840"}, {6, "36066699957791412000"},
              {7, "36296431179146480160"}, {8, "36405405308317074120"}, {9, "39396739226107437720"},
              {10, "39455539707005079840"}, {11, "39627800184024266760"}, {12, "39760742203092841320"}}},
        {13, {{1, "4676284915330182336000"}, {2, "4763811432330934761960"},
              {3, "4904947678163886171000"}, {4, "5774828568390535006080"},
              {5, "5912577739820599291080"}, {6, "6020595770815985085720"},
              {7, "6600206092275828396000"}, {8, "6642246905783805869280"},
              {9, "6662189171422024563960"}, {10, "7209603278377661102760"},
              {11, "7220363766381929610720"}, {12, "7251887433676440817080"},
              {13, "7276215823165989961560"}}},
        {14, {{1, "1856485111386082387392000"}, {2, "1891233138635381100498120"},
              {3, "1947264228231062809887000"}, {4, "2292606941651042397413760"},
              {5, "2347293362708777918558760"}, {6, "2359263817041145447806360"},
              {7, "2390176521013946079030840"}, {8, "2620281818633503873212000"},
              {9, "2636972021596170930104160"}, {10, "2644889101054543751892120"},
              {11, "2862212501515931457795720"}, {12, "2866484415253626055455840"},
              {13, "2878999311169547004380760"}, {14, "2888657681796898014739320"}}},
        {15, {{1, ""}, {2, ""}, {3, ""}, {4, ""}, {5, ""}, {6, ""}, {7, ""},
              {8, ""}, {9, ""}, {10, ""}, {11, ""}, {12, ""}, {13, ""}, {14, ""}, {15, ""}}},
    };

    taxicab_s = {
        { 1, {{1, "2"}}},
        { 2, {{1, "133"}, {2, "91"}}},
        { 3, {{1, "145173"}, {2, "134469"}, {3, "130851"}}},
        { 4, {{1, "323822187"}, {2, "285575472"}, {3, "246302784"}, {4, "232487724"}}},
        { 5, {{1, "121095997659"}, {2, "104100068163"}, {3, "89355577584"}, {4, "87791408208"},
              {5, "86940716268"}}},
        { 6, {{1, "819079563211308"}, {2, "755760121389819"}, {3, "649688525405283"},
              {4, "557668159701744"}, {5, "547906178626128"}, {6, "542597010228588"}}},
        { 7, {{1, "8355430624318552908"}, {2, "7709508998297543619"}, {3, "7372808174986053744"},
              {4, "6627472647659291883"}, {5, "5688772897117490544"}, {6, "5589190928165131728"},
              {7, "5535032101341826188"}}},
        { 8, {{1, "134764740539633939853132"}, {2, "124346670633541081030851"},
              {3, "118916023054350060836976"}, {4, "106894506334096718780907"},
              {5, "91754218057608004984176"}, {6, "90148060480375409640912"},
              {7, "89274532762542314586252"}, {8, "86634322450202263494576"}}},
        { 9, {{1, "2603789551966267351902363372"}, {2, "2461884490733190834848798352"},
              {3, "2402502023310647226597072171"}, {4, "2297576481433097525431213296"},
              {5, "2065308756881082703565904147"}, {6, "1772783247091044264299264496"},
              {7, "1741750676541333289672060752"}, {8, "1724873247505080060120974892"},
              {9, "1673861744060357932978702896"}}},
        {10, {{1, "370074005231413612458531003698988"}, {2, "360752633500370824957218786464016"},
              {3, "349905180783417680166224860971408"}, {4, "341465210071118979669015270592059"},
              {5, "326552247729604718192012914547184"}, {6, "293540268306751403575118390508963"},
              {7, "251963910125803030240590163551984"}, {8, "247553281906143159127800322621008"},
              {9, "245154509794649523864934040425068"}, {10, "237904295821554612656330063905584"}}},
        {11, {{1, "194152288937086863053472191313033747"}, {2, "185101142683991505060946159459945152"},
              {3, "153555937864230835830724422195182400"}, {4, "150800926452213055842620149572273600"},
              {5, "137558040967212865062415467817835952"}, {6, "136687394026673863360085702371076400"},
              {7, "136278240781255890414534093269995200"}, {8, "125930843206899567896806928637019200"},
              {9, "125743168822126253316484667434023600"}, {10, "125196568250239450334255234487902400"},
              {11, "124777967297605604303602946158603200"}}},
        {12, {{1, "630800786756595218060731149576046644003"},
              {2, "619210950221204902613782393590746164800"},
              {3, "601393612580288399943014072085361798848"},
              {4, "498903242120885985614023647712147617600"},
              {5, "489952210043240218432672865960316926400"},
              {6, "446926075102474598587787854940149008048"},
              {7, "444097343192663382056918447003627223600"},
              {8, "442768004298300387956821269034214404800"},
              {9, "409149309579216696096725711141675380800"},
              {10, "408539555503088197025258684493142676400"},
              {11, "406763650245027974135995256851194897600"},
              {12, "405403615749920608382405972069301796800"}}},
        {13, {{1, "21124887547691617257635825468152226061016467"},
              {2, "20736755511957930983632958578960498312987200"},
              {3, "20140070691701278225691598260066681281620672"},
              {4, "17106307452664126546074410640611785340793900"},
              {5, "16707770675386350772228037938232111565806400"},
              {6, "16408009562138071675091781608145053548209600"},
              {7, "14967107329106771832106427474090650130519472"},
              {8, "14872375926179104001704141871704472091140400"},
              {9, "14827857695945781692285987478686806202347200"},
              {10, "13702001228498387935583247340423566827611200"},
              {11, "13681581174242920630178888084990855089959600"},
              {12, "13622107883055741825840345156689665925726400"},
              {13, "13576561687849091254118393598628847873035200"}}},
        {14, {{1, "3329472401504128104358724816210004197250744347403"},
              {2, "3268299299484177544399406968671385178611599604800"},
              {3, "3174256401648346759873027110170849570114952493248"},
              {4, "2696108011306940320800241786656182875777185785100"},
              {5, "2633295028376967358860088831406824871775180897600"},
              {6, "2619934191978276806147862872086769509549310481600"},
              {7, "2586049979079019338639540607478133744679766846400"},
              {8, "2358950819033189201686461927763953276421043462448"},
              {9, "2344020297349162402604588096257470141812547303600"},
              {10, "2337003823600318706739502200528348838745739844800"},
              {11, "2159558711622402424139340030076817944132973620800"},
              {12, "2156340327291252477601864372187323679873442596400"},
              {13, "2146966801340532413428870959800701556887812177600"},
              {14, "2139788311060207423470345896686294084421204836800"}}},
        {15, {{1, ""}, {2, ""}, {3, ""}, {4, ""}, {5, ""}, {6, ""}, {7, ""},
              {8, ""}, {9, ""}, {10, ""}, {11, ""}, {12, ""}, {13, ""}, {14, ""}, {15, ""}}},
    };

    taxicab_x = {
        { 1, {{1, "1"}}},
        { 2, {{1, "12"}, {2, "10"}}},
        { 3, {{1, "436"}, {2, "423"}, {3, "414"}}},
        { 4, {{1, "19083"}, {2, "18948"}, {3, "18072"}, {4, "16630"}}},
        { 5, {{1, "365757"}, {2, "362753"}, {3, "342952"}, {4, "336588"}, {5, "331954"}}},
        { 6, {{1, "28906206"}, {2, "28894803"}, {3, "28657487"}, {4, "27093208"}, {5, "26590452"},
              {6, "26224366"}}},
        { 7, {{1, "2919526806"}, {2, "2918375103"}, {3, "2915734948"}, {4, "2894406187"},
              {5, "2736414008"}, {6, "2685635652"}, {7, "2648660966"}}},
        { 8, {{1, "370779904362"}, {2, "370633638081"}, {3, "370298338396"}, {4, "367589585749"},
              {5, "347524579016"}, {6, "341075727804"}, {7, "336379942682"}, {8, "299512063576"}}},
        { 9, {{1, "51538406706318"}, {2, "51530042142656"}, {3, "51518075693259"},
              {4, "51471469037044"}, {5, "51094952419111"}, {6, "48305916483224"},
              {7, "47409526164756"}, {8, "46756812032798"}, {9, "41632176837064"}}},
        {10, {{1, "19429979328281886"}, {2, "19429379778270560"}, {3, "19426825887781312"},
              {4, "19422314536358643"}, {5, "19404743826965588"}, {6, "19262797062004847"},
              {7, "18211330514175448"}, {8, "17873391364113012"}, {9, "17627318136364846"},
              {10, "15695330667573128"}}},
        {11, {{1, "443171971973855943"}, {2, "443138459854855128"}, {3, "439653507772479000"},
              {4, "438609133406051160"}, {5, "428126038425768228"}, {6, "426887616463852180"},
              {7, "426267111265435440"}, {8, "392138457234189120"}, {9, "390662458762053660"},
              {10, "385744811881975000"}, {11, "381087194739069520"}}},
        {12, {{1, "25260802402509788751"}, {2, "25260575914339118080"}, {3, "25258892211726742296"},
              {4, "25060249943031303000"}, {5, "25000720604144916120"}, {6, "24403184190268788996"},
              {7, "24332594138439574260"}, {8, "24297225342129820080"}, {9, "22351892062348779840"},
              {10, "22267760149437058620"}, {11, "21987454277272575000"}, {12, "21721970100126962640"}}},
        {13, {{1, "3301095294842755798440"}, {2, "3228183300935559592080"},
              {3, "3145363659034947883260"}, {4, "3119207030967834392040"},
              {5, "2215796933812267489320"}, {6, "2189382178449363779700"},
              {7, "2134423385456640009732"}, {8, "1445463900257465435760"},
              {9, "1326552000245870842080"}, {10, "1177721699343704435830"},
              {11, "282570403417892330832"}, {12, "141126040006876153320"},
              {13, "53558075670890994567"}}},
        {14, {{1, "1310534832052574051980680"}, {2, "1281588770471417158055760"},
              {3, "1248709372636874309654220"}, {4, "1238325191294230253639880"},
              {5, "879671382723470193260040"}, {6, "869184724844397420540900"},
              {7, "847366084026286083863604"}, {8, "573849168402213777996720"},
              {9, "539735366784231319470600"}, {10, "526641144097610724305760"},
              {11, "467555514639450661024510"}, {12, "112180450156903255340304"},
              {13, "56027037882729832868040"}, {14, "21262556041343724843099"}}},
        {15, {{1, ""}, {2, ""}, {3, ""}, {4, ""}, {5, ""}, {6, ""}, {7, ""},
              {8, ""}, {9, ""}, {10, ""}, {11, ""}, {12, ""}, {13, ""}, {14, ""}, {15, ""}}},
    };

    taxicab_y = {
        { 1, {{1, "1"}}},
        { 2, {{1, "1"}, {2, "9"}}},
        { 3, {{1, "167"}, {2, "228"}, {3, "255"}}},
        { 4, {{1, "2421"}, {2, "5436"}, {3, "10200"}, {4, "13322"}}},
        { 5, {{1, "38787"}, {2, "107839"}, {3, "205292"}, {4, "221424"}, {5, "231518"}}},
        { 6, {{1, "582162"}, {2, "3064173"}, {3, "8519281"}, {4, "16218068"}, {5, "17492496"},
              {6, "18289922"}}},
        { 7, {{1, "58798362"}, {2, "309481473"}, {3, "459531128"}, {4, "860447381"}, {5, "1638024868"},
              {6, "1766742096"}, {7, "1847282122"}}},
        { 8, {{1, "7467391974"}, {2, "39304147071"}, {3, "58360453256"}, {4, "109276817387"},
              {5, "208029158236"}, {6, "224376246192"}, {7, "234604829494"}, {8, "288873662876"}}},
        { 9, {{1, "1037967484386"}, {2, "4076877805588"}, {3, "5463276442869"}, {4, "8112103002584"},
              {5, "15189477616793"}, {6, "28916052994804"}, {7, "31188298220688"}, {8, "32610071299666"},
              {9, "40153439139764"}}},
        {10, {{1, "391313741613522"}, {2, "904069333568884"}, {3, "1536982932706676"},
              {4, "2059655218961613"}, {5, "3058262831974168"}, {6, "5726433061530961"},
              {7, "10901351979041108"}, {8, "11757988429199376"}, {9, "12293996879974082"}, 
              {10, "15137846555691028"}}},
        {11, {{1, "5134510178400057"}, {2, "27089483598685872"}, {3, "127174000598779680"},
              {4, "138573856797762960"}, {5, "204623083640747772"}, {6, "209891877907138700"},
              {7, "212424209933109720"}, {8, "299032406381730840"}, {9, "301539992238035460"},
              {10, "309479752750029680"}, {11, "316469686016945240"}}},
        {12, {{1, "292667080168803249"}, {2, "771180546485662040"}, {3, "1544100565125094704"},
              {4, "7248918034130441760"}, {5, "7898709837472488720"}, {6, "11663515767522623004"},
              {7, "11963837040706905900"}, {8, "12108179966187254040"}, {9, "17044847163758657880"},
              {10, "17187779557568021220"}, {11, "17640345906751691760"}, {12, "18038772102965878680"}}},
        {13, {{1, "3975120528323234163120"}, {2, "4023704132740881225000"},
              {3, "4075000107346981727460"}, {4, "4090396247409826710720"},
              {5, "4446392237609757074640"}, {6, "4452864727334442089580"},
              {7, "4465782706819188386268"}, {8, "4575131870558519649960"},
              {9, "4586025739574728449000"}, {10, "4597106869046830570250"},
              {11, "4622377274745993840168"}, {12, "4622685392324058608640"},
              {13, "4622726839659291341433"}}},
        {14, {{1, "1578122849744323962758640"},{2, "1597410540698129846325000"},
              {3, "1617775042616751745801620"}, {4, "1623887310221701204155840"},
              {5, "1765217718331073558632080"}, {6, "1767787296751773509563260"},
              {7, "1772915734607217789348396"}, {8, "1816327352611732301034120"},
              {9, "1819528450256914128335760"}, {10, "1820652218611167194253000"},
              {11, "1825051427011591736389250"}, {12, "1835083778074159554546696"},
              {13, "1835206100752651267630080"}, {14, "1835222555344738662548901"}}},
        {15, {{1, ""}, {2, ""}, {3, ""}, {4, ""}, {5, ""}, {6, ""}, {7, ""},
              {8, ""}, {9, ""}, {10, ""}, {11, ""}, {12, ""}, {13, ""}, {14, ""}, {15, ""}}},
    };

    taxicab_delta = {
        { 1, {{1, "1"}}},
        { 2, {{1, ""}, {2, ""}}},
        { 3, {{1, ""}, {2, ""}, {3, ""}}},
        { 4, {{1, ""}, {2, ""}, {3, ""}, {4, ""}}},
        { 5, {{1, ""}, {2, ""}, {3, ""}, {4, ""}, {5, ""}}},
        { 6, {{1, ""}, {2, ""}, {3, ""}, {4, ""},
              {5, ""}, {6, ""}}},
        { 7, {{1, ""}, {2, ""}, {3, ""}, {4, ""},
              {5, ""}, {6, ""}, {7, ""}}},
        { 8, {{1, ""}, {2, ""}, {3, ""}, 
              {4, ""}, {5, ""}, {6, ""}, 
              {7, ""}, {8, ""}}},
        { 9, {{1, ""}, {2, ""}, {3, ""}, 
              {4, ""}, {5, ""}, {6, ""}, 
              {7, ""}, {8, ""}, {9, ""}}},
        {10, {{1, ""}, {2, ""}, {3, ""},
              {4, ""}, {5, ""}, {6, ""},
              {7, ""}, {8, ""}, {9, ""}, 
              {10, ""}}},
        {11, {{1, ""}, {2, ""}, {3, ""},
              {4, ""}, {5, ""}, {6, ""},
              {7, ""}, {8, ""}, {9, ""},
              {10, ""}, {11, ""}}},
        {12, {{1, ""}, {2, ""}, {3, ""},
              {4, ""}, {5, ""}, {6, ""},
              {7, ""}, {8, ""}, {9, ""},
              {10, ""}, {11, ""}, {12, ""}}},
        {13, {{1, ""}, {2, ""}, {3, ""},
              {4, ""}, {5, ""}, {6, ""},
              {7, ""}, {8, ""}, {9, ""}, {10, ""}, {11, ""}, {12, ""}, {13, ""}}},
        {14, {{1, ""}, {2, ""}, {3, ""}, {4, ""}, {5, ""}, {6, ""}, {7, ""},
              {8, ""}, {9, ""}, {10, ""}, {11, ""}, {12, ""}, {13, ""}, {14, ""}}},
        {15, {{1, ""}, {2, ""}, {3, ""}, {4, ""}, {5, ""}, {6, ""}, {7, ""},
              {8, ""}, {9, ""}, {10, ""}, {11, ""}, {12, ""}, {13, ""}, {14, ""}, {15, ""}}},
    };

    fmpz_t N, r, s, rs, x, y, x3, y3, x3y3;
    for (const auto& [index, str] : taxicab) {
        cout << "Ta(" << setw(2) << index << ") ";
        if(index < 7) cout << "="; else cout << "<";
        cout << "= " << str << endl; // " = r * s = x(n)³ + y(n)³" << endl;
        for(unsigned short i = 1; i <= index; ++i) {
            fmpz_set_str(N, str.c_str(), 10);
            fmpz_set_str(r, taxicab_r[index][i].c_str(), 10);
            fmpz_set_str(s, taxicab_s[index][i].c_str(), 10);
            fmpz_mul(rs, r, s);
            cout << "      ";
            if(fmpz_cmp(N, rs) == 0) cout << " == "; else cout << " != ";
            cout << fmpz_get_str(NULL, 10, r) << " * " << fmpz_get_str(NULL, 10, s);

            fmpz_set_str(x, taxicab_x[index][i].c_str(), 10);
            fmpz_set_str(y, taxicab_y[index][i].c_str(), 10);
            fmpz_pow_ui(x3, x, 3);
            fmpz_pow_ui(y3, y, 3);
            fmpz_add(x3y3, x3, y3);
            if(fmpz_cmp(N, x3y3) == 0) cout << " == "; else cout << " != ";
            cout << fmpz_get_str(NULL, 10, x) << "³ + " << fmpz_get_str(NULL, 10, y) << "³" << endl;
        }
    }

    return 0;
}
